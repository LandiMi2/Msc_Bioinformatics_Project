Building DAG of jobs...
Using shell: /bin/bash
Provided cores: 4
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	20
	1	all
	1	check_merging
	2	check_parsing
	1	check_trimming
	1	copy_final_j_database
	1	copy_final_v_database
	2	dendrogram
	1	dont_trim_forward_primers
	1	dont_trim_reverse_primers
	2	igdiscover_clusterplot
	6	igdiscover_count
	1	igdiscover_discover
	1	igdiscover_discover_j
	2	igdiscover_filter
	2	igdiscover_germlinefilter
	2	igdiscover_igblast
	1	json_stats
	1	json_stats_nofinal
	1	parse_pear_stats
	1	pear_merge
	2	plot_errorhistograms
	1	read_length_histogram
	1	trimmed_fastq_stats
	36

[Tue Sep 10 10:14:18 2019]
rule pear_merge:
    input: reads/1-limited.1.fastq.gz, reads/1-limited.2.fastq.gz
    output: reads/2-merged.fastq.gz, reads/2-pear.log
    log: reads/2-pear.log
    jobid: 40
    threads: 4
    resources: time=60

igdiscover merge -j 4 reads/1-limited.1.fastq.gz reads/1-limited.2.fastq.gz reads/2-merged.fastq.gz | tee reads/2-pear.log
[Tue Sep 10 10:14:22 2019]
Finished job 40.
1 of 36 steps (3%) done

[Tue Sep 10 10:14:22 2019]
rule parse_pear_stats:
    input: reads/2-pear.log
    output: stats/reads.json
    jobid: 31

[Tue Sep 10 10:14:23 2019]
Finished job 31.
2 of 36 steps (6%) done

[Tue Sep 10 10:14:23 2019]
rule check_merging:
    input: stats/reads.json
    output: stats/merging-successful
    jobid: 13

[Tue Sep 10 10:14:23 2019]
Finished job 13.
3 of 36 steps (8%) done

[Tue Sep 10 10:14:23 2019]
rule dont_trim_forward_primers:
    input: reads/2-merged.fastq.gz, stats/merging-successful
    output: reads/3-forward-primer-trimmed.fastq.gz
    jobid: 43
    wildcards: ext=fastq
    resources: time=1

[Tue Sep 10 10:14:23 2019]
Finished job 43.
4 of 36 steps (11%) done

[Tue Sep 10 10:14:23 2019]
rule dont_trim_reverse_primers:
    input: reads/3-forward-primer-trimmed.fastq.gz
    output: reads/4-trimmed.fastq.gz
    jobid: 39
    wildcards: ext=fastq
    resources: time=1

[Tue Sep 10 10:14:24 2019]
Finished job 39.
5 of 36 steps (14%) done

[Tue Sep 10 10:14:24 2019]
rule trimmed_fastq_stats:
    input: reads/4-trimmed.fastq.gz
    output: stats/trimmed.json
    jobid: 32

[Tue Sep 10 10:14:24 2019]
Finished job 32.
6 of 36 steps (17%) done

[Tue Sep 10 10:14:24 2019]
rule check_trimming:
    input: stats/reads.json, stats/trimmed.json
    output: stats/trimming-successful
    jobid: 14

[Tue Sep 10 10:14:24 2019]
Finished job 14.
7 of 36 steps (19%) done

[Tue Sep 10 10:14:24 2019]
rule 20:
    input: reads/4-trimmed.fastq.gz, stats/trimming-successful
    output: reads/sequences.fasta.gz, stats/groups.json
    jobid: 30

igdiscover dereplicate --json=stats/groups.json --minimum-length=300 reads/4-trimmed.fastq.gz | gzip > reads/sequences.fasta.gz
[Tue Sep 10 10:14:25 2019]
Finished job 30.
8 of 36 steps (22%) done

[Tue Sep 10 10:14:25 2019]
rule igdiscover_igblast:
    input: reads/sequences.fasta.gz, iteration-01/database/V.fasta, iteration-01/database/D.fasta, iteration-01/database/J.fasta
    output: iteration-01/assigned.tab.gz, iteration-01/stats/assigned.json
    log: iteration-01/igblast.log
    jobid: 37
    wildcards: dir=iteration-01
    threads: 4

time igdiscover igblast --sequence-type=Ig --threads=4 --stats=iteration-01/stats/assigned.json iteration-01/database reads/sequences.fasta.gz | gzip 2>&1 > iteration-01/assigned.tab.gz | tee iteration-01/igblast.log >&2
[Tue Sep 10 10:14:28 2019]
Error in rule igdiscover_igblast:
    jobid: 37
    output: iteration-01/assigned.tab.gz, iteration-01/stats/assigned.json
    log: iteration-01/igblast.log (check log file(s) for error message)
    shell:
        time igdiscover igblast --sequence-type=Ig --threads=4 --stats=iteration-01/stats/assigned.json iteration-01/database reads/sequences.fasta.gz | gzip 2>&1 > iteration-01/assigned.tab.gz | tee iteration-01/igblast.log >&2
        (exited with non-zero exit code)

Removing output files of failed job igdiscover_igblast since they might be corrupted:
iteration-01/assigned.tab.gz
Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
Complete log: /home/cofia/Documents/Project/Msc_Bioinformatics_Project/igdiscover_Trial/Data/discovertest/.snakemake/log/2019-09-10T101418.710332.snakemake.log
