Building DAG of jobs...
Using shell: /bin/bash
Provided cores: 4
Rules claiming more threads will be scaled down.
Unlimited resources: time
Job counts:
	count	jobs
	1	20
	1	23
	1	24
	1	all
	1	check_merging
	3	check_parsing
	1	check_trimming
	3	copy_d_database
	1	copy_final_j_database
	1	copy_final_v_database
	9	dendrogram
	1	dont_trim_forward_primers
	1	dont_trim_reverse_primers
	2	gzip_limited
	3	igdiscover_clusterplot
	9	igdiscover_count
	2	igdiscover_discover
	1	igdiscover_discover_j
	3	igdiscover_filter
	4	igdiscover_germlinefilter
	3	igdiscover_igblast
	1	json_stats
	1	json_stats_nofinal
	1	parse_pear_stats
	1	pear_merge
	3	plot_errorhistograms
	1	read_length_histogram
	1	trimmed_fastq_stats
	2	vj_database_iteration_1
	63

[Tue Jan 21 14:33:28 2020]
rule gzip_limited:
    input: reads.2.fastq
    output: reads/1-limited.2.fastq.gz
    jobid: 62
    wildcards: nr=2., ext=fastq

pigz < reads.2.fastq > reads/1-limited.2.fastq.gz

[Tue Jan 21 14:33:28 2020]
rule vj_database_iteration_1:
    input: database/V.fasta
    output: iteration-01/database/V.fasta
    jobid: 38
    wildcards: gene=V

cp -p database/V.fasta iteration-01/database/V.fasta

[Tue Jan 21 14:33:28 2020]
rule copy_d_database:
    input: database/D.fasta
    output: iteration-01/database/D.fasta
    jobid: 39
    wildcards: base=iteration-01

cp -p database/D.fasta iteration-01/database/D.fasta

[Tue Jan 21 14:33:28 2020]
rule gzip_limited:
    input: reads.1.fastq
    output: reads/1-limited.1.fastq.gz
    jobid: 61
    wildcards: nr=1., ext=fastq

pigz < reads.1.fastq > reads/1-limited.1.fastq.gz
[Tue Jan 21 14:33:28 2020]
Finished job 38.
1 of 63 steps (2%) done
[Tue Jan 21 14:33:28 2020]
Finished job 39.
2 of 63 steps (3%) done

[Tue Jan 21 14:33:28 2020]
rule dendrogram:
    input: iteration-01/database/V.fasta
    output: iteration-01/dendrogram_V.pdf
    jobid: 4
    wildcards: dir=iteration-01, gene=V

igdiscover dendrogram --mark database/V.fasta iteration-01/database/V.fasta iteration-01/dendrogram_V.pdf

[Tue Jan 21 14:33:28 2020]
rule dendrogram:
    input: iteration-01/database/D.fasta
    output: iteration-01/dendrogram_D.pdf
    jobid: 6
    wildcards: dir=iteration-01, gene=D

igdiscover dendrogram --mark database/D.fasta iteration-01/database/D.fasta iteration-01/dendrogram_D.pdf
[Tue Jan 21 14:33:29 2020]
Finished job 6.
3 of 63 steps (5%) done

[Tue Jan 21 14:33:29 2020]
rule copy_d_database:
    input: database/D.fasta
    output: final/database/D.fasta
    jobid: 50
    wildcards: base=final

cp -p database/D.fasta final/database/D.fasta
[Tue Jan 21 14:33:30 2020]
Finished job 50.
4 of 63 steps (6%) done

[Tue Jan 21 14:33:30 2020]
rule copy_d_database:
    input: database/D.fasta
    output: iteration-02/database/D.fasta
    jobid: 43
    wildcards: base=iteration-02

cp -p database/D.fasta iteration-02/database/D.fasta
[Tue Jan 21 14:33:30 2020]
Finished job 43.
5 of 63 steps (8%) done

[Tue Jan 21 14:33:30 2020]
rule dendrogram:
    input: iteration-02/database/D.fasta
    output: iteration-02/dendrogram_D.pdf
    jobid: 17
    wildcards: dir=iteration-02, gene=D

igdiscover dendrogram --mark database/D.fasta iteration-02/database/D.fasta iteration-02/dendrogram_D.pdf
[Tue Jan 21 14:33:30 2020]
Finished job 4.
6 of 63 steps (10%) done

[Tue Jan 21 14:33:30 2020]
rule dendrogram:
    input: final/database/D.fasta
    output: final/dendrogram_D.pdf
    jobid: 33
    wildcards: dir=final, gene=D

igdiscover dendrogram --mark database/D.fasta final/database/D.fasta final/dendrogram_D.pdf
[Tue Jan 21 14:33:32 2020]
Finished job 17.
7 of 63 steps (11%) done

[Tue Jan 21 14:33:32 2020]
rule vj_database_iteration_1:
    input: database/J.fasta
    output: iteration-01/database/J.fasta
    jobid: 40
    wildcards: gene=J

cp -p database/J.fasta iteration-01/database/J.fasta
[Tue Jan 21 14:33:32 2020]
Finished job 40.
8 of 63 steps (13%) done

[Tue Jan 21 14:33:32 2020]
rule dendrogram:
    input: iteration-01/database/J.fasta
    output: iteration-01/dendrogram_J.pdf
    jobid: 8
    wildcards: dir=iteration-01, gene=J

igdiscover dendrogram --mark database/J.fasta iteration-01/database/J.fasta iteration-01/dendrogram_J.pdf
[Tue Jan 21 14:33:32 2020]
Finished job 33.
9 of 63 steps (14%) done
[Tue Jan 21 14:33:34 2020]
Finished job 8.
10 of 63 steps (16%) done
[Tue Jan 21 14:33:35 2020]
Finished job 61.
11 of 63 steps (17%) done
[Tue Jan 21 14:33:36 2020]
Finished job 62.
12 of 63 steps (19%) done

[Tue Jan 21 14:33:36 2020]
rule pear_merge:
    input: reads/1-limited.1.fastq.gz, reads/1-limited.2.fastq.gz
    output: reads/2-merged.fastq.gz, reads/2-pear.log
    log: reads/2-pear.log
    jobid: 57
    threads: 4
    resources: time=60

igdiscover merge -j 4 reads/1-limited.1.fastq.gz reads/1-limited.2.fastq.gz reads/2-merged.fastq.gz | tee reads/2-pear.log
[Tue Jan 21 14:34:43 2020]
Finished job 57.
13 of 63 steps (21%) done

[Tue Jan 21 14:34:43 2020]
rule parse_pear_stats:
    input: reads/2-pear.log
    output: stats/reads.json
    jobid: 46

[Tue Jan 21 14:34:43 2020]
Finished job 46.
14 of 63 steps (22%) done

[Tue Jan 21 14:34:43 2020]
rule check_merging:
    input: stats/reads.json
    output: stats/merging-successful
    jobid: 24

[Tue Jan 21 14:34:43 2020]
Finished job 24.
15 of 63 steps (24%) done

[Tue Jan 21 14:34:43 2020]
rule dont_trim_forward_primers:
    input: reads/2-merged.fastq.gz, stats/merging-successful
    output: reads/3-forward-primer-trimmed.fastq.gz
    jobid: 60
    wildcards: ext=fastq
    resources: time=1

[Tue Jan 21 14:34:44 2020]
Finished job 60.
16 of 63 steps (25%) done

[Tue Jan 21 14:34:44 2020]
rule dont_trim_reverse_primers:
    input: reads/3-forward-primer-trimmed.fastq.gz
    output: reads/4-trimmed.fastq.gz
    jobid: 56
    wildcards: ext=fastq
    resources: time=1

[Tue Jan 21 14:34:44 2020]
Finished job 56.
17 of 63 steps (27%) done

[Tue Jan 21 14:34:44 2020]
rule trimmed_fastq_stats:
    input: reads/4-trimmed.fastq.gz
    output: stats/trimmed.json
    jobid: 47

[Tue Jan 21 14:34:45 2020]
Finished job 47.
18 of 63 steps (29%) done

[Tue Jan 21 14:34:45 2020]
rule check_trimming:
    input: stats/reads.json, stats/trimmed.json
    output: stats/trimming-successful
    jobid: 25

[Tue Jan 21 14:34:45 2020]
Finished job 25.
19 of 63 steps (30%) done

[Tue Jan 21 14:34:45 2020]
rule 20:
    input: reads/4-trimmed.fastq.gz, stats/trimming-successful
    output: reads/sequences.fasta.gz, stats/groups.json
    jobid: 45

igdiscover dereplicate --json=stats/groups.json --minimum-length=300 reads/4-trimmed.fastq.gz | pigz > reads/sequences.fasta.gz
[Tue Jan 21 14:34:49 2020]
Finished job 45.
20 of 63 steps (32%) done

[Tue Jan 21 14:34:49 2020]
rule igdiscover_igblast:
    input: reads/sequences.fasta.gz, iteration-01/database/V.fasta, iteration-01/database/D.fasta, iteration-01/database/J.fasta
    output: iteration-01/assigned.tab.gz, iteration-01/stats/assigned.json
    log: iteration-01/igblast.log
    jobid: 52
    wildcards: dir=iteration-01
    threads: 4

time igdiscover igblast --sequence-type=Ig --threads=4 --stats=iteration-01/stats/assigned.json iteration-01/database reads/sequences.fasta.gz | pigz 2>&1 > iteration-01/assigned.tab.gz | tee iteration-01/igblast.log >&2
[Tue Jan 21 14:56:53 2020]
Finished job 52.
21 of 63 steps (33%) done

[Tue Jan 21 14:56:53 2020]
rule read_length_histogram:
    input: reads/sequences.fasta.gz
    output: stats/readlengths.txt, stats/readlengths.pdf
    jobid: 23

sqt readlenhisto --bins 100 --left 300 --title "Lengths of pre-processed reads" --plot stats/readlengths.pdf reads/sequences.fasta.gz  > stats/readlengths.txt

[Tue Jan 21 14:56:53 2020]
rule check_parsing:
    input: iteration-01/stats/assigned.json
    output: iteration-01/stats/parsing-successful
    jobid: 53
    wildcards: dir=iteration-01

[Tue Jan 21 14:56:53 2020]
Finished job 53.
22 of 63 steps (35%) done

[Tue Jan 21 14:56:53 2020]
rule igdiscover_filter:
    input: iteration-01/assigned.tab.gz, iteration-01/stats/parsing-successful
    output: iteration-01/filtered.tab.gz, iteration-01/stats/filtered.json
    jobid: 37
    wildcards: dir=iteration-01

[Tue Jan 21 14:56:55 2020]
Finished job 23.
23 of 63 steps (37%) done
[Tue Jan 21 14:57:09 2020]
Finished job 37.
24 of 63 steps (38%) done

[Tue Jan 21 14:57:09 2020]
rule igdiscover_discover:
    input: iteration-01/database/V.fasta, iteration-01/filtered.tab.gz
    output: iteration-01/candidates.tab, iteration-01/read_names_map.tab
    jobid: 9
    wildcards: dir=iteration-01
    threads: 4

time igdiscover discover -j 4 --seed=1 --d-coverage=70 --read-names=iteration-01/read_names_map.tab --subsample=1000 --database=iteration-01/database/V.fasta iteration-01/filtered.tab.gz > iteration-01/candidates.tab
[Tue Jan 21 15:00:42 2020]
Finished job 9.
25 of 63 steps (40%) done

[Tue Jan 21 15:00:42 2020]
rule igdiscover_count:
    input: iteration-01/filtered.tab.gz
    output: iteration-01/expressed_D.pdf, iteration-01/expressed_D.tab
    jobid: 5
    wildcards: dir=iteration-01, gene=D

igdiscover count --gene=D --allele-ratio=0.2 --plot=iteration-01/expressed_D.pdf iteration-01/filtered.tab.gz > iteration-01/expressed_D.tab

[Tue Jan 21 15:00:42 2020]
rule igdiscover_count:
    input: iteration-01/filtered.tab.gz
    output: iteration-01/expressed_V.pdf, iteration-01/expressed_V.tab
    jobid: 3
    wildcards: dir=iteration-01, gene=V

igdiscover count --gene=V --allele-ratio=0.2 --plot=iteration-01/expressed_V.pdf iteration-01/filtered.tab.gz > iteration-01/expressed_V.tab

[Tue Jan 21 15:00:42 2020]
rule igdiscover_count:
    input: iteration-01/filtered.tab.gz
    output: iteration-01/expressed_J.pdf, iteration-01/expressed_J.tab
    jobid: 7
    wildcards: dir=iteration-01, gene=J

igdiscover count --gene=J --allele-ratio=0.2 --plot=iteration-01/expressed_J.pdf iteration-01/filtered.tab.gz > iteration-01/expressed_J.tab

[Tue Jan 21 15:00:42 2020]
rule igdiscover_discover_j:
    input: iteration-01/database/J.fasta, iteration-01/filtered.tab.gz
    output: iteration-01/new_J.tab, iteration-01/new_J.fasta
    jobid: 27

time igdiscover discoverj --allele-ratio=0.2 --cross-mapping-ratio=0.1 --database=iteration-01/database/J.fasta --fasta=iteration-01/new_J.fasta iteration-01/filtered.tab.gz > iteration-01/new_J.tab
[Tue Jan 21 15:00:45 2020]
Finished job 5.
26 of 63 steps (41%) done

[Tue Jan 21 15:00:45 2020]
rule plot_errorhistograms:
    input: iteration-01/filtered.tab.gz
    output: iteration-01/errorhistograms.pdf, iteration-01/v-shm-distributions.pdf
    jobid: 2
    wildcards: dir=iteration-01

igdiscover errorplot --multi=iteration-01/errorhistograms.pdf --boxplot=iteration-01/v-shm-distributions.pdf iteration-01/filtered.tab.gz
[Tue Jan 21 15:00:45 2020]
Finished job 7.
27 of 63 steps (43%) done

[Tue Jan 21 15:00:45 2020]
rule igdiscover_clusterplot:
    input: iteration-01/filtered.tab.gz
    output: iteration-01/clusterplots/done
    jobid: 1
    wildcards: dir=iteration-01

igdiscover clusterplot iteration-01/filtered.tab.gz iteration-01/clusterplots/ && touch iteration-01/clusterplots/done
[Tue Jan 21 15:00:45 2020]
Finished job 3.
28 of 63 steps (44%) done

[Tue Jan 21 15:00:45 2020]
rule igdiscover_germlinefilter:
    input: iteration-01/candidates.tab, database/V.fasta
    output: iteration-01/new_V_pregermline.tab, iteration-01/new_V_pregermline.fasta, iteration-01/annotated_V_pregermline.tab
    log: iteration-01/new_V_pregermline.log
    jobid: 11
    wildcards: nr=01, pre=pre

igdiscover germlinefilter --whitelist=database/V.fasta --allow-stop --unique-CDR3=2 --cluster-size=0 --unique-J=1 --cross-mapping-ratio=0.02 --clonotype-ratio=0.12 --exact-ratio=0.12 --cdr3-shared-ratio=0.8 --unique-D-ratio=0.3 --unique-D-threshold=10 --annotate=iteration-01/annotated_V_pregermline.tab --fasta=iteration-01/new_V_pregermline.fasta iteration-01/candidates.tab  2> >(tee iteration-01/new_V_pregermline.log >&2)  > iteration-01/new_V_pregermline.tab
[Tue Jan 21 15:00:46 2020]
Finished job 11.
29 of 63 steps (46%) done

[Tue Jan 21 15:00:46 2020]
rule igdiscover_germlinefilter:
    input: iteration-01/candidates.tab, database/V.fasta
    output: iteration-01/new_V_germline.tab, iteration-01/new_V_germline.fasta, iteration-01/annotated_V_germline.tab
    log: iteration-01/new_V_germline.log
    jobid: 10
    wildcards: nr=01, pre=

igdiscover germlinefilter --whitelist=database/V.fasta --unique-CDR3=2 --cluster-size=100 --unique-J=1 --cross-mapping-ratio=0.02 --clonotype-ratio=0.12 --exact-ratio=0.12 --cdr3-shared-ratio=0.8 --unique-D-ratio=0.3 --unique-D-threshold=10 --annotate=iteration-01/annotated_V_germline.tab --fasta=iteration-01/new_V_germline.fasta iteration-01/candidates.tab  2> >(tee iteration-01/new_V_germline.log >&2)  > iteration-01/new_V_germline.tab
[Tue Jan 21 15:00:47 2020]
Finished job 10.
30 of 63 steps (48%) done

[Tue Jan 21 15:00:47 2020]
rule 23:
    input: iteration-01/new_V_pregermline.fasta
    output: iteration-02/database/V.fasta
    jobid: 42

[Tue Jan 21 15:00:47 2020]
Finished job 42.
31 of 63 steps (49%) done

[Tue Jan 21 15:00:47 2020]
rule dendrogram:
    input: iteration-02/database/V.fasta
    output: iteration-02/dendrogram_V.pdf
    jobid: 15
    wildcards: dir=iteration-02, gene=V

igdiscover dendrogram --mark database/V.fasta iteration-02/database/V.fasta iteration-02/dendrogram_V.pdf
[Tue Jan 21 15:00:47 2020]
Finished job 27.
32 of 63 steps (51%) done

[Tue Jan 21 15:00:47 2020]
rule copy_final_j_database:
    input: iteration-01/new_J.fasta
    output: final/database/J.fasta
    jobid: 51

[Tue Jan 21 15:00:48 2020]
Finished job 51.
33 of 63 steps (52%) done

[Tue Jan 21 15:00:48 2020]
rule dendrogram:
    input: final/database/J.fasta
    output: final/dendrogram_J.pdf
    jobid: 35
    wildcards: dir=final, gene=J

igdiscover dendrogram --mark database/J.fasta final/database/J.fasta final/dendrogram_J.pdf
[Tue Jan 21 15:00:49 2020]
Finished job 15.
34 of 63 steps (54%) done

[Tue Jan 21 15:00:49 2020]
rule 24:
    input: iteration-01/new_J.fasta
    output: iteration-02/database/J.fasta
    jobid: 44

[Tue Jan 21 15:00:49 2020]
Finished job 35.
35 of 63 steps (56%) done
[Tue Jan 21 15:00:49 2020]
Finished job 44.
36 of 63 steps (57%) done

[Tue Jan 21 15:00:49 2020]
rule dendrogram:
    input: iteration-02/database/J.fasta
    output: iteration-02/dendrogram_J.pdf
    jobid: 19
    wildcards: dir=iteration-02, gene=J

igdiscover dendrogram --mark database/J.fasta iteration-02/database/J.fasta iteration-02/dendrogram_J.pdf
[Tue Jan 21 15:00:50 2020]
Finished job 19.
37 of 63 steps (59%) done
[Tue Jan 21 15:00:51 2020]
Finished job 2.
38 of 63 steps (60%) done
[Tue Jan 21 15:01:34 2020]
Finished job 1.
39 of 63 steps (62%) done

[Tue Jan 21 15:01:34 2020]
rule igdiscover_igblast:
    input: reads/sequences.fasta.gz, iteration-02/database/V.fasta, iteration-02/database/D.fasta, iteration-02/database/J.fasta
    output: iteration-02/assigned.tab.gz, iteration-02/stats/assigned.json
    log: iteration-02/igblast.log
    jobid: 54
    wildcards: dir=iteration-02
    threads: 4

time igdiscover igblast --sequence-type=Ig --threads=4 --stats=iteration-02/stats/assigned.json iteration-02/database reads/sequences.fasta.gz | pigz 2>&1 > iteration-02/assigned.tab.gz | tee iteration-02/igblast.log >&2
[Tue Jan 21 15:24:11 2020]
Finished job 54.
40 of 63 steps (63%) done

[Tue Jan 21 15:24:11 2020]
rule check_parsing:
    input: iteration-02/stats/assigned.json
    output: iteration-02/stats/parsing-successful
    jobid: 55
    wildcards: dir=iteration-02

[Tue Jan 21 15:24:12 2020]
Finished job 55.
41 of 63 steps (65%) done

[Tue Jan 21 15:24:12 2020]
rule igdiscover_filter:
    input: iteration-02/assigned.tab.gz, iteration-02/stats/parsing-successful
    output: iteration-02/filtered.tab.gz, iteration-02/stats/filtered.json
    jobid: 41
    wildcards: dir=iteration-02

[Tue Jan 21 15:24:27 2020]
Finished job 41.
42 of 63 steps (67%) done

[Tue Jan 21 15:24:27 2020]
rule igdiscover_discover:
    input: iteration-02/database/V.fasta, iteration-02/filtered.tab.gz
    output: iteration-02/candidates.tab, iteration-02/read_names_map.tab
    jobid: 20
    wildcards: dir=iteration-02
    threads: 4

time igdiscover discover -j 4 --seed=1 --d-coverage=70 --read-names=iteration-02/read_names_map.tab --subsample=1000 --database=iteration-02/database/V.fasta iteration-02/filtered.tab.gz > iteration-02/candidates.tab
[Tue Jan 21 15:27:52 2020]
Finished job 20.
43 of 63 steps (68%) done

[Tue Jan 21 15:27:52 2020]
rule igdiscover_count:
    input: iteration-02/filtered.tab.gz
    output: iteration-02/expressed_J.pdf, iteration-02/expressed_J.tab
    jobid: 18
    wildcards: dir=iteration-02, gene=J

igdiscover count --gene=J --allele-ratio=0.2 --plot=iteration-02/expressed_J.pdf iteration-02/filtered.tab.gz > iteration-02/expressed_J.tab

[Tue Jan 21 15:27:52 2020]
rule plot_errorhistograms:
    input: iteration-02/filtered.tab.gz
    output: iteration-02/errorhistograms.pdf, iteration-02/v-shm-distributions.pdf
    jobid: 13
    wildcards: dir=iteration-02

igdiscover errorplot --multi=iteration-02/errorhistograms.pdf --boxplot=iteration-02/v-shm-distributions.pdf iteration-02/filtered.tab.gz

[Tue Jan 21 15:27:52 2020]
rule igdiscover_clusterplot:
    input: iteration-02/filtered.tab.gz
    output: iteration-02/clusterplots/done
    jobid: 12
    wildcards: dir=iteration-02

igdiscover clusterplot iteration-02/filtered.tab.gz iteration-02/clusterplots/ && touch iteration-02/clusterplots/done

[Tue Jan 21 15:27:52 2020]
rule igdiscover_count:
    input: iteration-02/filtered.tab.gz
    output: iteration-02/expressed_D.pdf, iteration-02/expressed_D.tab
    jobid: 16
    wildcards: dir=iteration-02, gene=D

igdiscover count --gene=D --allele-ratio=0.2 --plot=iteration-02/expressed_D.pdf iteration-02/filtered.tab.gz > iteration-02/expressed_D.tab
[Tue Jan 21 15:27:55 2020]
Finished job 16.
44 of 63 steps (70%) done

[Tue Jan 21 15:27:55 2020]
rule igdiscover_count:
    input: iteration-02/filtered.tab.gz
    output: iteration-02/expressed_V.pdf, iteration-02/expressed_V.tab
    jobid: 14
    wildcards: dir=iteration-02, gene=V

igdiscover count --gene=V --allele-ratio=0.2 --plot=iteration-02/expressed_V.pdf iteration-02/filtered.tab.gz > iteration-02/expressed_V.tab
[Tue Jan 21 15:27:55 2020]
Finished job 18.
45 of 63 steps (71%) done

[Tue Jan 21 15:27:55 2020]
rule igdiscover_germlinefilter:
    input: iteration-02/candidates.tab, database/V.fasta
    output: iteration-02/new_V_pregermline.tab, iteration-02/new_V_pregermline.fasta, iteration-02/annotated_V_pregermline.tab
    log: iteration-02/new_V_pregermline.log
    jobid: 22
    wildcards: nr=02, pre=pre

igdiscover germlinefilter --whitelist=database/V.fasta --allow-stop --unique-CDR3=2 --cluster-size=0 --unique-J=1 --cross-mapping-ratio=0.02 --clonotype-ratio=0.12 --exact-ratio=0.12 --cdr3-shared-ratio=0.8 --unique-D-ratio=0.3 --unique-D-threshold=10 --annotate=iteration-02/annotated_V_pregermline.tab --fasta=iteration-02/new_V_pregermline.fasta iteration-02/candidates.tab  2> >(tee iteration-02/new_V_pregermline.log >&2)  > iteration-02/new_V_pregermline.tab
[Tue Jan 21 15:27:57 2020]
Finished job 22.
46 of 63 steps (73%) done

[Tue Jan 21 15:27:57 2020]
rule igdiscover_germlinefilter:
    input: iteration-02/candidates.tab, database/V.fasta
    output: iteration-02/new_V_germline.tab, iteration-02/new_V_germline.fasta, iteration-02/annotated_V_germline.tab
    log: iteration-02/new_V_germline.log
    jobid: 21
    wildcards: nr=02, pre=

igdiscover germlinefilter --whitelist=database/V.fasta --unique-CDR3=2 --cluster-size=100 --unique-J=1 --cross-mapping-ratio=0.02 --clonotype-ratio=0.12 --exact-ratio=0.12 --cdr3-shared-ratio=0.8 --unique-D-ratio=0.3 --unique-D-threshold=10 --annotate=iteration-02/annotated_V_germline.tab --fasta=iteration-02/new_V_germline.fasta iteration-02/candidates.tab  2> >(tee iteration-02/new_V_germline.log >&2)  > iteration-02/new_V_germline.tab
[Tue Jan 21 15:27:59 2020]
Finished job 21.
47 of 63 steps (75%) done

[Tue Jan 21 15:27:59 2020]
rule json_stats_nofinal:
    input: database/V.fasta, iteration-01/new_V_pregermline.fasta, iteration-02/new_V_pregermline.fasta, iteration-01/new_V_germline.fasta, iteration-02/new_V_germline.fasta, iteration-01/stats/filtered.json, iteration-02/stats/filtered.json, stats/groups.json, stats/reads.json, stats/trimmed.json
    output: stats/stats_nofinal.json
    jobid: 26

[Tue Jan 21 15:27:59 2020]
Finished job 14.
48 of 63 steps (76%) done

[Tue Jan 21 15:27:59 2020]
rule copy_final_v_database:
    input: iteration-02/new_V_germline.fasta
    output: final/database/V.fasta
    jobid: 49

[Tue Jan 21 15:27:59 2020]
Finished job 26.
49 of 63 steps (78%) done
[Tue Jan 21 15:27:59 2020]
Finished job 49.
50 of 63 steps (79%) done

[Tue Jan 21 15:27:59 2020]
rule dendrogram:
    input: final/database/V.fasta
    output: final/dendrogram_V.pdf
    jobid: 31
    wildcards: dir=final, gene=V

igdiscover dendrogram --mark database/V.fasta final/database/V.fasta final/dendrogram_V.pdf
[Tue Jan 21 15:28:00 2020]
Finished job 31.
51 of 63 steps (81%) done
[Tue Jan 21 15:28:02 2020]
Finished job 13.
52 of 63 steps (83%) done
[Tue Jan 21 15:28:42 2020]
Finished job 12.
53 of 63 steps (84%) done

[Tue Jan 21 15:28:42 2020]
rule igdiscover_igblast:
    input: reads/sequences.fasta.gz, final/database/V.fasta, final/database/D.fasta, final/database/J.fasta
    output: final/assigned.tab.gz, final/stats/assigned.json
    log: final/igblast.log
    jobid: 58
    wildcards: dir=final
    threads: 4

time igdiscover igblast --sequence-type=Ig --threads=4 --stats=final/stats/assigned.json final/database reads/sequences.fasta.gz | pigz 2>&1 > final/assigned.tab.gz | tee final/igblast.log >&2
[Tue Jan 21 15:47:24 2020]
Finished job 58.
54 of 63 steps (86%) done

[Tue Jan 21 15:47:24 2020]
rule check_parsing:
    input: final/stats/assigned.json
    output: final/stats/parsing-successful
    jobid: 59
    wildcards: dir=final

[Tue Jan 21 15:47:24 2020]
Finished job 59.
55 of 63 steps (87%) done

[Tue Jan 21 15:47:24 2020]
rule igdiscover_filter:
    input: final/assigned.tab.gz, final/stats/parsing-successful
    output: final/filtered.tab.gz, final/stats/filtered.json
    jobid: 48
    wildcards: dir=final

[Tue Jan 21 15:47:40 2020]
Finished job 48.
56 of 63 steps (89%) done

[Tue Jan 21 15:47:40 2020]
rule igdiscover_clusterplot:
    input: final/filtered.tab.gz
    output: final/clusterplots/done
    jobid: 28
    wildcards: dir=final

igdiscover clusterplot final/filtered.tab.gz final/clusterplots/ && touch final/clusterplots/done

[Tue Jan 21 15:47:40 2020]
rule plot_errorhistograms:
    input: final/filtered.tab.gz
    output: final/errorhistograms.pdf, final/v-shm-distributions.pdf
    jobid: 29
    wildcards: dir=final

igdiscover errorplot --multi=final/errorhistograms.pdf --boxplot=final/v-shm-distributions.pdf final/filtered.tab.gz

[Tue Jan 21 15:47:40 2020]
rule igdiscover_count:
    input: final/filtered.tab.gz
    output: final/expressed_J.pdf, final/expressed_J.tab
    jobid: 34
    wildcards: dir=final, gene=J

igdiscover count --gene=J --allele-ratio=0.2 --plot=final/expressed_J.pdf final/filtered.tab.gz > final/expressed_J.tab

[Tue Jan 21 15:47:40 2020]
rule igdiscover_count:
    input: final/filtered.tab.gz
    output: final/expressed_V.pdf, final/expressed_V.tab
    jobid: 30
    wildcards: dir=final, gene=V

igdiscover count --gene=V --allele-ratio=0.2 --plot=final/expressed_V.pdf final/filtered.tab.gz > final/expressed_V.tab
[Tue Jan 21 15:47:43 2020]
Finished job 30.
57 of 63 steps (90%) done

[Tue Jan 21 15:47:43 2020]
rule igdiscover_count:
    input: final/filtered.tab.gz
    output: final/expressed_D.pdf, final/expressed_D.tab
    jobid: 32
    wildcards: dir=final, gene=D

igdiscover count --gene=D --allele-ratio=0.2 --plot=final/expressed_D.pdf final/filtered.tab.gz > final/expressed_D.tab
[Tue Jan 21 15:47:43 2020]
Finished job 34.
58 of 63 steps (92%) done

[Tue Jan 21 15:47:43 2020]
rule json_stats:
    input: stats/stats_nofinal.json, final/stats/filtered.json
    output: stats/stats.json
    jobid: 36

[Tue Jan 21 15:47:44 2020]
Finished job 36.
59 of 63 steps (94%) done
[Tue Jan 21 15:47:44 2020]
Finished job 29.
60 of 63 steps (95%) done
[Tue Jan 21 15:47:46 2020]
Finished job 32.
61 of 63 steps (97%) done
[Tue Jan 21 15:48:02 2020]
Finished job 28.
62 of 63 steps (98%) done

[Tue Jan 21 15:48:02 2020]
Job 0: IgDiscover finished.

[Tue Jan 21 15:48:02 2020]
Finished job 0.
63 of 63 steps (100%) done
Complete log: /home/mkofia/Documents/Bovine_IgDiscover_Analysis/Bovine_experiment_2/.snakemake/log/2020-01-21T143328.133450.snakemake.log
